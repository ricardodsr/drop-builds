import{k as J,r as x,at as Q,au as C,D as ee,a2 as ie,av as le,j as e,aw as ce,ah as F,a9 as de,ax as me,a6 as pe,ay as ue,X as R,n as w,ak as E,C as y,b as S,c as k,B as j,e as N,az as $,aA as P,aB as O,m as I,aC as xe,aD as he,x as z,am as ge,y as _,z as se,aj as A,L as fe,Z as D,i as te,aE as be,T as ve,f as je,g as H,h as W,aF as ye,O as Ne,u as we,aq as Y}from"./index-QpcEAcYr.js";import{S as V}from"./status-indicator-BUKMw0FD.js";import{T as L}from"./trending-up-46vWibqc.js";import{P as Ce}from"./progress-DhvDzLy4.js";import{D as Pe}from"./download-WmXYY0Yh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=J("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=J("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Te=()=>{const[s,r]=x.useState(!1),[m,t]=x.useState(""),[c,d]=x.useState(""),[n,a]=x.useState(""),{apiKey:u}=Q();return{improvePrompt:async h=>{if(console.log("🚀 Starting prompt improvement process"),console.log("📝 Original prompt length:",h.length),console.log("🔑 API key present:",!!u),!(u!=null&&u.trim())){const o="Claude API key not configured. Please configure it in Settings.";console.error("❌ No API key found"),a(o),C.error(o);return}if(!(h!=null&&h.trim())){const o="Prompt cannot be empty";console.error("❌ Empty prompt provided"),a(o),C.error(o);return}if(h.trim().length<10){const o="Prompt must be at least 10 characters long";console.error("❌ Prompt too short"),a(o),C.error(o);return}r(!0),t(""),d(""),a("");try{console.log("📡 Calling Supabase Edge Function...");const{data:o,error:i}=await ee.functions.invoke("improve-prompt",{body:{originalPrompt:h.trim(),apiKey:u.trim()}});if(console.log("📡 Edge function response received"),console.log("✅ Function error:",i),console.log("📄 Function data:",o),i){console.error("❌ Edge function error:",i);const l=`Communication error: ${i.message||"Please try again."}`;a(l),C.error(l);return}if(o!=null&&o.error){console.error("❌ API error:",o.error);let l="Claude API error";o.error.includes("API key")||o.error.includes("invalid_credentials")?l="Invalid API key. Please check your key in Settings.":o.error.includes("rate limit")||o.error.includes("429")?l="Rate limit exceeded. Please try again in a few minutes.":(o.error.includes("insufficient")||o.error.includes("quota"))&&(l="Insufficient credits in Claude account. Please check your balance."),a(l),C.error(l);return}if(o!=null&&o.improvedPrompt)console.log("✅ Success! Improved prompt received"),t(o.improvedPrompt),d(o.analysis||"Prompt improved successfully!"),C.success("Prompt improved successfully!");else{console.error("❌ Invalid response structure:",o);const l="Invalid API response. Please try again.";a(l),C.error(l)}}catch(o){console.error("❌ Unexpected error:",o);const i="Connection error. Please check your internet and try again.";a(i),C.error(i)}finally{r(!1),console.log("🏁 Prompt improvement process finished")}},loading:s,improvedPrompt:m,analysis:c,error:n}};var B="Collapsible",[Ie,Ke]=ie(B),[Ae,q]=Ie(B),re=x.forwardRef((s,r)=>{const{__scopeCollapsible:m,open:t,defaultOpen:c,disabled:d,onOpenChange:n,...a}=s,[u=!1,p]=le({prop:t,defaultProp:c,onChange:n});return e.jsx(Ae,{scope:m,disabled:d,contentId:ce(),open:u,onOpenToggle:x.useCallback(()=>p(h=>!h),[p]),children:e.jsx(F.div,{"data-state":G(u),"data-disabled":d?"":void 0,...a,ref:r})})});re.displayName=B;var ae="CollapsibleTrigger",ne=x.forwardRef((s,r)=>{const{__scopeCollapsible:m,...t}=s,c=q(ae,m);return e.jsx(F.button,{type:"button","aria-controls":c.contentId,"aria-expanded":c.open||!1,"data-state":G(c.open),"data-disabled":c.disabled?"":void 0,disabled:c.disabled,...t,ref:r,onClick:de(s.onClick,c.onOpenToggle)})});ne.displayName=ae;var U="CollapsibleContent",oe=x.forwardRef((s,r)=>{const{forceMount:m,...t}=s,c=q(U,s.__scopeCollapsible);return e.jsx(me,{present:m||c.open,children:({present:d})=>e.jsx(Ee,{...t,ref:r,present:d})})});oe.displayName=U;var Ee=x.forwardRef((s,r)=>{const{__scopeCollapsible:m,present:t,children:c,...d}=s,n=q(U,m),[a,u]=x.useState(t),p=x.useRef(null),h=pe(r,p),o=x.useRef(0),i=o.current,l=x.useRef(0),v=l.current,T=n.open||a,g=x.useRef(T),b=x.useRef();return x.useEffect(()=>{const f=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(f)},[]),ue(()=>{const f=p.current;if(f){b.current=b.current||{transitionDuration:f.style.transitionDuration,animationName:f.style.animationName},f.style.transitionDuration="0s",f.style.animationName="none";const Z=f.getBoundingClientRect();o.current=Z.height,l.current=Z.width,g.current||(f.style.transitionDuration=b.current.transitionDuration,f.style.animationName=b.current.animationName),u(t)}},[n.open,t]),e.jsx(F.div,{"data-state":G(n.open),"data-disabled":n.disabled?"":void 0,id:n.contentId,hidden:!T,...d,ref:h,style:{"--radix-collapsible-content-height":i?`${i}px`:void 0,"--radix-collapsible-content-width":v?`${v}px`:void 0,...s.style},children:T&&c})});function G(s){return s?"open":"closed"}var Se=re;const ke=Se,$e=ne,Oe=oe,X=[{id:"1",title:"Content Analysis",description:"Template for detailed content analysis",category:"Analysis",template:`Analyze the following content: {CONTENT}

Please provide:
1. Main summary
2. Key points
3. Recommendations
4. Conclusions`,variables:["CONTENT"]},{id:"2",title:"Creative Writing",description:"Template for generating creative content",category:"Creativity",template:`Write a {TYPE} about {TOPIC} with a {TONE} tone.

Requirements:
- Target audience: {AUDIENCE}
- Length: {LENGTH}
- Style: {STYLE}`,variables:["TYPE","TOPIC","TONE","AUDIENCE","LENGTH","STYLE"]},{id:"3",title:"Problem Solving",description:"Template for structured problem analysis and resolution",category:"Solution",template:`Problem: {PROBLEM}

Context: {CONTEXT}

Please provide:
1. Situation analysis
2. Possible causes
3. Alternative solutions
4. Final recommendation
5. Implementation steps`,variables:["PROBLEM","CONTEXT"]},{id:"4",title:"Code Review",description:"Template for systematic code analysis",category:"Technical",template:`Review the following {LANGUAGE} code:

{CODE}

Please analyze:
1. Code quality and readability
2. Performance considerations
3. Security issues
4. Best practices compliance
5. Improvement suggestions`,variables:["LANGUAGE","CODE"]},{id:"5",title:"Learning Assistant",description:"Template for educational content creation",category:"Education",template:`Explain {TOPIC} for a {LEVEL} audience.

Please include:
1. Clear definition
2. Key concepts
3. Practical examples
4. Common misconceptions
5. Further learning resources`,variables:["TOPIC","LEVEL"]}],Me=({onTemplateSelect:s})=>{const[r,m]=x.useState(null),[t,c]=x.useState({}),{toast:d}=R(),{t:n}=w(),a=i=>{m(i);const l={};i.variables.forEach(v=>{l[v]=""}),c(l)},u=(i,l)=>{c(v=>({...v,[i]:l}))},p=()=>{if(!r)return;let i=r.template;r.variables.forEach(l=>{const v=t[l]||`{${l}}`;i=i.replace(new RegExp(`{${l}}`,"g"),v)}),s(i),d({title:n("templates.applied"),description:n("templates.appliedDesc")})},h=i=>{navigator.clipboard.writeText(i),d({title:n("templates.copied"),description:n("templates.copiedDesc")})},o=[...new Set(X.map(i=>i.category))];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),n("templates.title")]}),e.jsx("p",{className:"text-sm text-gray-600",children:n("templates.description")})]}),r?e.jsxs(y,{className:"border-blue-200 bg-blue-50",children:[e.jsx(S,{children:e.jsxs(k,{className:"flex items-center justify-between",children:[e.jsx("span",{children:r.title}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>m(null),children:n("templates.back")})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:n("templates.variables")}),e.jsx("div",{className:"space-y-3",children:r.variables.map(i=>e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium",children:[i,":"]}),e.jsx($,{placeholder:`Enter value for ${i}`,value:t[i]||"",onChange:l=>u(i,l.target.value),className:"mt-1",rows:2})]},i))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{onClick:p,className:"flex-1",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),n("templates.apply")]}),e.jsx(j,{variant:"outline",onClick:()=>h(r.template),children:e.jsx(O,{className:"h-4 w-4"})})]})]})]}):e.jsx("div",{className:"space-y-4",children:o.map(i=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-700",children:i}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:X.filter(l=>l.category===i).map(l=>e.jsxs(y,{className:"cursor-pointer hover:shadow-md transition-shadow",children:[e.jsx(S,{className:"pb-2",children:e.jsxs(k,{className:"text-base flex items-center justify-between",children:[l.title,e.jsxs(I,{variant:"outline",className:"text-xs",children:[l.variables.length," vars"]})]})}),e.jsxs(N,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:l.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",onClick:()=>a(l),className:"flex-1",children:n("templates.use")}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>h(l.template),children:e.jsx(O,{className:"h-3 w-3"})})]})]})]},l.id))})]},i))})]})},Re=({showTemplates:s,onToggle:r,onTemplateSelect:m})=>{const{t}=w();return e.jsxs(ke,{open:s,onOpenChange:r,children:[e.jsx($e,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"w-full justify-between","data-tour":"templates-section",children:[t(s?"prompt.hideTemplates":"prompt.showTemplates"),s?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(he,{className:"h-4 w-4"})]})}),e.jsx(Oe,{className:"mt-4",children:e.jsx(Me,{onTemplateSelect:m})})]})},De=()=>{const[s,r]=x.useState(null),m=[{name:"minLength",validator:d=>d.trim().length>=10,message:"Prompt must be at least 10 characters long"},{name:"maxLength",validator:d=>d.length<=1e4,message:"Prompt must not exceed 10,000 characters"},{name:"noMaliciousContent",validator:d=>![/inject/i,/script/i,/<script/i,/javascript:/i,/data:text\/html/i].some(a=>a.test(d)),message:"Prompt contains potentially malicious content"},{name:"noPersonalInfo",validator:d=>![/\b\d{3}-\d{2}-\d{4}\b/,/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/,/\b\d{4}[\s-]?\d{4}[\s-]?\d{4}[\s-]?\d{4}\b/].some(a=>a.test(d)),message:"Prompt may contain personal information"}],t=[{name:"tooShort",validator:d=>d.trim().length>=50,message:"Short prompts may not provide enough context for optimal results"},{name:"lacksClarityWords",validator:d=>["specific","detailed","example","context","format"].some(a=>d.toLowerCase().includes(a)),message:"Consider adding more specific instructions for better results"}];return{validatePrompt:x.useCallback(d=>{const n=[],a=[];m.forEach(p=>{p.validator(d)||n.push(p.message)}),t.forEach(p=>{p.validator(d)||a.push(p.message)});const u={isValid:n.length===0,errors:n,warnings:a};return r(u),u},[]),validationResult:s,clearValidation:()=>r(null)}},ze=({validation:s})=>s?e.jsxs("div",{className:"space-y-2",children:[s.errors.map((r,m)=>e.jsxs(z,{variant:"destructive",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx(_,{children:r})]},`error-${m}`)),s.warnings.map((r,m)=>e.jsxs(z,{className:"border-amber-200 bg-amber-50",children:[e.jsx(se,{className:"h-4 w-4 text-amber-600"}),e.jsx(_,{className:"text-amber-800",children:r})]},`warning-${m}`)),s.isValid&&s.errors.length===0&&s.warnings.length===0&&e.jsxs(z,{className:"border-green-200 bg-green-50",children:[e.jsx(A,{className:"h-4 w-4 text-green-600"}),e.jsx(_,{className:"text-green-800",children:"Prompt looks good! Ready for improvement."})]})]}):null,_e=({value:s,onChange:r,disabled:m,placeholder:t})=>{const{t:c}=w(),{validatePrompt:d,validationResult:n}=De(),[a,u]=x.useState(!1),[p,h]=x.useState(!1);x.useEffect(()=>{if(s.trim().length>0){const b=setTimeout(()=>{d(s),u(!0)},500);return()=>clearTimeout(b)}else u(!1)},[s,d]);const o=s.length,i=1e4,l=o>i*.8,v=s.trim().split(/\s+/).filter(b=>b.length>0).length,g=s.length<10?{score:0,label:"Too Short",color:"red"}:s.length<50?{score:3,label:"Basic",color:"orange"}:s.length<150?{score:6,label:"Good",color:"yellow"}:s.length<300?{score:8,label:"Great",color:"blue"}:{score:10,label:"Excellent",color:"green"};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(E,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"original",className:"text-lg font-semibold",children:c("prompt.original")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your prompt to optimize with advanced AI techniques"})]})]}),s.length>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(I,{variant:g.score>=8?"default":g.score>=6?"secondary":"outline",className:`
                ${g.color==="green"?"bg-green-100 text-green-800":""}
                ${g.color==="blue"?"bg-blue-100 text-blue-800":""}
                ${g.color==="yellow"?"bg-yellow-100 text-yellow-800":""}
                ${g.color==="orange"?"bg-orange-100 text-orange-800":""}
                ${g.color==="red"?"bg-red-100 text-red-800":""}
              `,children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),g.label]})})]}),e.jsx(y,{className:`
        relative transition-all duration-300 border-2
        ${p?"border-primary shadow-lg shadow-primary/10":"border-border"}
        ${(n==null?void 0:n.isValid)===!1?"border-red-300":""}
        ${(n==null?void 0:n.isValid)===!0?"border-green-300":""}
        ${m?"opacity-60":""}
      `,children:e.jsxs(N,{className:"p-0",children:[e.jsx($,{id:"original",placeholder:t||"Describe what you want to achieve with AI. Be specific about your goals, context, and desired output format...",value:s,onChange:b=>r(b.target.value),onFocus:()=>h(!0),onBlur:()=>h(!1),rows:6,disabled:m,maxLength:i,className:`
              min-h-[160px] resize-none border-0 text-base leading-relaxed
              focus:ring-0 focus:outline-none bg-transparent
              transition-all duration-200
            `}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-muted/30 border-t",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),v," words"]}),e.jsxs("span",{className:`flex items-center gap-1 ${l?"text-amber-600 font-medium":""}`,children:[o," / ",i," characters"]}),(n==null?void 0:n.isValid)&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(A,{className:"h-3 w-3"}),"Ready to optimize"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-1.5 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${g.color==="green"?"bg-green-500":g.color==="blue"?"bg-blue-500":g.color==="yellow"?"bg-yellow-500":g.color==="orange"?"bg-orange-500":"bg-red-500"}`,style:{width:`${Math.min(g.score/10*100,100)}%`}})}),e.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:[g.score,"/10"]})]})]})]})}),a&&n&&e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(ze,{validation:n})}),m&&e.jsx(V,{status:"pending",message:"Processing your prompt with advanced AI optimization...",className:"animate-pulse"}),s.length===0&&!m&&e.jsx(y,{className:"border-dashed border-2 border-muted bg-muted/20",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(se,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Tips for Better Prompts:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:"• Be specific about your desired outcome"}),e.jsx("li",{children:"• Include context and background information"}),e.jsx("li",{children:"• Specify the format you want for the response"}),e.jsx("li",{children:"• Mention any constraints or requirements"})]})]})]})})})]})},Le=({onImprove:s,isImproving:r,disabled:m})=>{const{t}=w();return e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs(j,{onClick:s,disabled:m,size:"lg",className:`
          relative overflow-hidden px-8 py-4 text-lg font-semibold
          bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary
          shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98]
          transition-all duration-300 group
          ${r?"bg-blue-600 hover:bg-blue-600":""}
          ${m?"opacity-50 cursor-not-allowed":""}
        `,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -skew-x-12 -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),e.jsx("div",{className:"relative flex items-center gap-3",children:r?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:t("prompt.improving")}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-1 h-1 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-1 h-1 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-1 h-1 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"h-5 w-5 group-hover:rotate-12 transition-transform duration-300"}),e.jsx("span",{children:t("prompt.improve")}),e.jsx(be,{className:"h-5 w-5 group-hover:translate-x-1 transition-transform duration-300"})]})})]}),!m&&!r&&e.jsx(y,{className:"border-dashed border-2 border-muted bg-muted/20",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3 text-center",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(P,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"font-medium",children:"Ready to optimize!"}),e.jsx("p",{children:"Click to transform your prompt with advanced AI techniques"})]})]})})}),m&&!r&&e.jsx("div",{className:"text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"Please enter a prompt and configure your API key to continue"})})]})},Fe=({improvedPrompt:s,analysis:r})=>{const{t:m}=w(),{toast:t}=R(),[c,d]=x.useState("improved"),n=async()=>{try{await navigator.clipboard.writeText(s),t({title:"Copied to clipboard",description:"The improved prompt has been copied to your clipboard."})}catch(h){console.error("Failed to copy text:",h),t({title:"Copy failed",description:"Failed to copy the prompt. Please try selecting and copying manually.",variant:"destructive"})}},a=async()=>{try{await navigator.clipboard.writeText(r),t({title:"Analysis copied",description:"The technical analysis has been copied to your clipboard."})}catch(h){console.error("Failed to copy analysis:",h),t({title:"Copy failed",description:"Failed to copy the analysis. Please try selecting and copying manually.",variant:"destructive"})}},p=(s.length,{clarity:92,structure:88,effectiveness:95,overall:Math.round(275/3)});return e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 bg-green-500 rounded-xl shadow-lg",children:e.jsx(A,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Optimization Complete!"}),e.jsx("p",{className:"text-muted-foreground",children:"Your prompt has been enhanced with advanced AI techniques"})]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[p.overall,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[p.clarity,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Clarity"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[p.effectiveness,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Effectiveness"})]})]})]}),e.jsxs(ve,{value:c,onValueChange:d,className:"w-full",children:[e.jsxs(je,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsxs(H,{value:"improved",className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Optimized Prompt"]}),e.jsxs(H,{value:"analysis",className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Technical Analysis"]})]}),e.jsx(W,{value:"improved",className:"space-y-4",children:e.jsxs(y,{className:"border-2 border-green-200 bg-gradient-to-br from-green-50/50 to-emerald-50/30",children:[e.jsxs(S,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center gap-2 text-green-800",children:[e.jsx(P,{className:"h-5 w-5"}),m("prompt.improved")]}),e.jsxs(j,{onClick:n,variant:"outline",size:"sm",className:"border-green-200 hover:bg-green-50",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Copy Prompt"]})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(I,{className:"bg-green-100 text-green-800",children:[e.jsx(L,{className:"h-3 w-3 mr-1"}),"+",p.overall-60,"% Improvement"]}),e.jsx(I,{className:"bg-blue-100 text-blue-800",children:"Professional Grade"})]})]}),e.jsx(N,{children:e.jsx($,{readOnly:!0,value:s,rows:8,className:"resize-none bg-white/50 border-green-200 focus:border-green-300 text-base leading-relaxed"})})]})}),e.jsx(W,{value:"analysis",className:"space-y-4",children:e.jsxs(y,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50/50 to-indigo-50/30",children:[e.jsx(S,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(E,{className:"h-5 w-5"}),"Technical Analysis"]}),e.jsxs(j,{onClick:a,variant:"outline",size:"sm",className:"border-blue-200 hover:bg-blue-50",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Copy Analysis"]})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-white/50 rounded-lg border border-blue-100",children:[e.jsx(M,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[p.clarity,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Clarity Score"})]}),e.jsxs("div",{className:"text-center p-4 bg-white/50 rounded-lg border border-purple-100",children:[e.jsx(D,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[p.structure,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Structure"})]}),e.jsxs("div",{className:"text-center p-4 bg-white/50 rounded-lg border border-green-100",children:[e.jsx(L,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[p.effectiveness,"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Effectiveness"})]})]}),e.jsx($,{readOnly:!0,value:r,rows:12,className:"resize-none bg-white/50 border-blue-200 focus:border-blue-300 text-sm leading-relaxed"})]})]})})]})]})},Ve=({isProcessing:s,currentStep:r})=>{const[m,t]=x.useState([{id:"analysis",label:"Analisando prompt original",status:"pending"},{id:"processing",label:"Aplicando Engenheiro Elite v3.0",status:"pending"},{id:"optimization",label:"Otimizando resultado",status:"pending"},{id:"completion",label:"Finalizando melhorias",status:"pending"}]);return x.useEffect(()=>{if(!s){t(a=>a.map(u=>({...u,status:"pending"})));return}const c=["analysis","processing","optimization","completion"];let d=0;const n=setInterval(()=>{d<c.length?(t(a=>a.map(u=>u.id===c[d]?{...u,status:"processing"}:c.indexOf(u.id)<d?{...u,status:"completed"}:u)),d++):clearInterval(n)},1500);return()=>clearInterval(n)},[s]),s?e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-3",children:"A processar o seu prompt..."}),e.jsx("div",{className:"space-y-2",children:m.map(c=>e.jsxs("div",{className:"flex items-center gap-3",children:[c.status==="completed"&&e.jsx(A,{className:"h-4 w-4 text-green-600"}),c.status==="processing"&&e.jsx(te,{className:"h-4 w-4 text-blue-600 animate-spin"}),c.status==="pending"&&e.jsx(ye,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:Ne("text-sm",c.status==="completed"&&"text-green-700",c.status==="processing"&&"text-blue-700 font-medium",c.status==="pending"&&"text-gray-500"),children:c.label})]},c.id))})]}):null},Be=({isProcessing:s,progress:r})=>{if(w(),!s)return null;const t=r<20?{stage:"Analyzing",icon:K,description:"Understanding your prompt structure and intent",color:"blue"}:r<40?{stage:"Optimizing",icon:M,description:"Applying advanced prompt engineering techniques",color:"purple"}:r<60?{stage:"Enhancing",icon:D,description:"Restructuring for maximum AI effectiveness",color:"amber"}:r<80?{stage:"Refining",icon:P,description:"Fine-tuning clarity and precision",color:"green"}:{stage:"Finalizing",icon:A,description:"Preparing your optimized prompt",color:"emerald"},c=t.icon;return e.jsxs("div",{className:"space-y-6 animate-scale-in",children:[e.jsx(Ve,{isProcessing:s}),e.jsxs(y,{className:"relative overflow-hidden border-2 border-primary/20 bg-gradient-to-br from-primary/5 via-white to-accent/5",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/10 via-transparent to-accent/10 animate-pulse"}),e.jsxs(N,{className:"relative p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`
                p-3 rounded-xl shadow-lg animate-pulse
                ${t.color==="blue"?"bg-blue-500":""}
                ${t.color==="purple"?"bg-purple-500":""}
                ${t.color==="amber"?"bg-amber-500":""}
                ${t.color==="green"?"bg-green-500":""}
                ${t.color==="emerald"?"bg-emerald-500":""}
              `,children:e.jsx(c,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-foreground",children:[t.stage," Your Prompt"]}),e.jsx("p",{className:"text-muted-foreground",children:t.description})]})]}),e.jsxs(I,{className:`
              px-3 py-1 text-sm font-medium
              ${t.color==="blue"?"bg-blue-100 text-blue-800":""}
              ${t.color==="purple"?"bg-purple-100 text-purple-800":""}
              ${t.color==="amber"?"bg-amber-100 text-amber-800":""}
              ${t.color==="green"?"bg-green-100 text-green-800":""}
              ${t.color==="emerald"?"bg-emerald-100 text-emerald-800":""}
            `,children:[Math.round(r),"%"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ce,{value:r,className:`
                h-3 bg-muted/50
                [&>div]:transition-all [&>div]:duration-500 [&>div]:ease-out
                ${t.color==="blue"?"[&>div]:bg-blue-500":""}
                ${t.color==="purple"?"[&>div]:bg-purple-500":""}
                ${t.color==="amber"?"[&>div]:bg-amber-500":""}
                ${t.color==="green"?"[&>div]:bg-green-500":""}
                ${t.color==="emerald"?"[&>div]:bg-emerald-500":""}
              `}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsx("span",{children:"AI Engine: Claude-4 Advanced"}),e.jsxs("span",{children:["ETA: ",Math.max(10-Math.floor(r/10),1),"s"]})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"p-1 bg-green-100 rounded",children:e.jsx(A,{className:"h-3 w-3 text-green-600"})}),e.jsx("span",{className:"text-muted-foreground",children:"Structure"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"p-1 bg-blue-100 rounded",children:e.jsx(K,{className:"h-3 w-3 text-blue-600"})}),e.jsx("span",{className:"text-muted-foreground",children:"Context"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"p-1 bg-purple-100 rounded",children:e.jsx(M,{className:"h-3 w-3 text-purple-600"})}),e.jsx("span",{className:"text-muted-foreground",children:"Precision"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("div",{className:"p-1 bg-amber-100 rounded",children:e.jsx(P,{className:"h-3 w-3 text-amber-600"})}),e.jsx("span",{className:"text-muted-foreground",children:"Enhancement"})]})]})]})]})]})},qe=({originalPrompt:s,improvedPrompt:r})=>{const{toast:m}=R(),{t}=w(),c=d=>{const n=new Date().toISOString(),a={original_prompt:s,improved_prompt:r,created_at:n,improvement_ratio:Math.round(r.length/s.length*100),character_improvement:r.length-s.length};let u="",p="",h="";switch(d){case"json":u=JSON.stringify(a,null,2),p="application/json",h=`prompt-improvement-${Date.now()}.json`;break;case"csv":u=["Original Prompt,Improved Prompt,Created At,Improvement Ratio,Character Improvement",`"${a.original_prompt.replace(/"/g,'""')}","${a.improved_prompt.replace(/"/g,'""')}","${a.created_at}","${a.improvement_ratio}%","${a.character_improvement}"`].join(`
`),p="text/csv",h=`prompt-improvement-${Date.now()}.csv`;break;case"markdown":u=`# Prompt Improvement

## Original Prompt
${a.original_prompt}

## Improved Prompt
${a.improved_prompt}

## Metadata
- **Date:** ${new Date(a.created_at).toLocaleDateString()}
- **Improvement Ratio:** ${a.improvement_ratio}%
- **Character Improvement:** ${a.character_improvement} characters
`,p="text/markdown",h=`prompt-improvement-${Date.now()}.md`;break;case"txt":u=`PROMPT IMPROVEMENT
==================

Original Prompt:
${a.original_prompt}

Improved Prompt:
${a.improved_prompt}

Metadata:
- Date: ${new Date(a.created_at).toLocaleDateString()}
- Improvement Ratio: ${a.improvement_ratio}%
- Character Improvement: ${a.character_improvement} characters
`,p="text/plain",h=`prompt-improvement-${Date.now()}.txt`;break}const o=new Blob([u],{type:p}),i=URL.createObjectURL(o),l=document.createElement("a");l.href=i,l.download=h,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),m({title:t("export.completed"),description:t("export.completedDesc").replace("{format}",d.toUpperCase())})};return e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),t("export.title")]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("json"),className:"text-xs",children:"JSON"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("csv"),className:"text-xs",children:"CSV"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("markdown"),className:"text-xs",children:"Markdown"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("txt"),className:"text-xs",children:"TXT"})]})]})},Ue=({hasApiKey:s})=>{const{t:r}=w();return s?null:e.jsx(V,{status:"error",message:`⚠️ ${r("apikey.configure")}`})},Xe=()=>{const[s,r]=x.useState(""),[m,t]=x.useState(!1),[c,d]=x.useState(0),{toast:n}=R(),{apiKey:a}=Q(),{user:u}=we(),{t:p}=w(),{improvePrompt:h,loading:o,improvedPrompt:i,error:l,analysis:v}=Te();Y.useEffect(()=>{if(o){d(0);const b=setInterval(()=>{d(f=>f>=90?f:f+Math.random()*15)},200);return()=>clearInterval(b)}else d(0)},[o]);const T=b=>{r(b),t(!1)},g=x.useCallback(async()=>{if(console.log("🎯 Improve prompt button clicked"),!(a!=null&&a.trim())){n({title:p("apikey.notConfigured"),description:p("apikey.configure"),variant:"destructive"});return}if(!(s!=null&&s.trim())){n({title:p("prompt.empty"),description:p("prompt.emptyDesc"),variant:"destructive"});return}if(s.trim().length<10){n({title:p("prompt.tooShort"),description:p("prompt.tooShortDesc"),variant:"destructive"});return}try{await h(s)}catch(b){console.error("💥 Improve prompt error:",b),n({title:p("common.error"),description:"An error occurred while processing the prompt. Please try again.",variant:"destructive"})}},[s,a,n,h,p]);return Y.useEffect(()=>{(async()=>{if(i&&s&&u&&!o)try{console.log("💾 Saving to history...");const{error:f}=await ee.from("prompt_history").insert({user_id:u.id,original_prompt:s,improved_prompt:i,analysis:v||"Prompt improved successfully"});f?console.error("❌ Error saving to history:",f):console.log("✅ Successfully saved to history")}catch(f){console.error("💥 Error saving prompt to history:",f)}})()},[i,s,u,o,v]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50/80 via-white to-blue-50/80",children:e.jsx("div",{className:"container mx-auto px-6 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8","data-tour":"improve-section",children:[e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(Ue,{hasApiKey:!!a})}),e.jsx(y,{className:"card-enhanced animate-scale-in",children:e.jsxs(N,{className:"p-8 space-y-8",children:[e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.1s"},children:e.jsx(Re,{showTemplates:m,onToggle:t,onTemplateSelect:T})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.2s"},children:e.jsx(_e,{value:s,onChange:r,disabled:o})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.3s"},children:e.jsx(Le,{onImprove:g,isImproving:o,disabled:!a||!s.trim()})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.4s"},children:e.jsx(Be,{isProcessing:o,progress:c})}),i&&!o&&e.jsxs("div",{className:"space-y-6 animate-slide-in-right",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(I,{className:"bg-green-100 text-green-800 px-4 py-2 text-sm font-medium",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Prompt Successfully Optimized"]})}),e.jsx(Fe,{improvedPrompt:i,analysis:v}),e.jsx(qe,{originalPrompt:s,improvedPrompt:i})]}),l&&!o&&e.jsx("div",{className:"animate-fade-in-up",children:e.jsx(V,{status:"error",message:l})})]})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 animate-fade-in-up",style:{animationDelay:"0.5s"},children:[e.jsxs(y,{className:"card-enhanced text-center p-6",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full w-fit mx-auto mb-4",children:e.jsx(M,{className:"h-6 w-6 text-blue-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Precision Targeting"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced algorithms analyze and optimize prompt structure for maximum AI response quality"})]}),e.jsxs(y,{className:"card-enhanced text-center p-6",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-full w-fit mx-auto mb-4",children:e.jsx(P,{className:"h-6 w-6 text-purple-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"AI Enhancement"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Leverages cutting-edge Claude AI to transform basic prompts into professional-grade instructions"})]}),e.jsxs(y,{className:"card-enhanced text-center p-6",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full w-fit mx-auto mb-4",children:e.jsx(L,{className:"h-6 w-6 text-green-600"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Performance Boost"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Measurable improvements in AI response quality, consistency, and relevance to your needs"})]})]})]})})})};export{Xe as PromptImprover};
